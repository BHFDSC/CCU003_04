-- Databricks notebook source
-- DBTITLE 1,CCU003 A&E data extract
-- MAGIC %md
-- MAGIC 
-- MAGIC This workbook defines the base extract for the A&E data for CCU003
-- MAGIC 
-- MAGIC Approach: 
-- MAGIC 1. Define cardiac specific extract saved out as table CCU003_KMC_AEactivity_CVD
-- MAGIC 2. Define general extract saved out as table CCU003_KMC_AEactivity_all

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC CREATE TABLE dars_nic_391419_j3w9t_collab.CCU003_KMC_AEactivity_CVD AS
-- MAGIC 
-- MAGIC SELECT PERSON_ID_DEID, AEKEY, ARRIVALAGE, SEX,ETHNOS,ARRIVALDATE, ARRIVALTIME, AEARRIVALMODE, AEATTENDCAT, PROCODET, SITETRET,AEDEPTTYPE,LSOA11, RESGOR_ONS, DIAG3_01,DIAG3_02, DIAG3_03, DIAG3_04, DIAG3_05, DIAG3_06, DIAG3_07, DIAG3_08, DIAG3_09, DIAG3_10, DIAG3_11, DIAG3_12, TREAT2_01, TREAT2_02, TREAT2_03, TREAT2_04, TREAT2_05, TREAT2_06, TREAT2_07, TREAT2_08, TREAT2_09, TREAT2_10, TREAT2_11, TREAT2_12, DEPDUR, DEPTIME, AEATTENDDISP
-- MAGIC FROM dars_nic_391419_j3w9t_collab.hes_ae_all_years
-- MAGIC WHERE ARRIVALDATE > '2014-12-31' AND AEATTENDCAT <> 4 AND (DIAG3_01 IN(201,202,21,22) OR DIAG3_02 IN(201,202,21,22) OR DIAG3_03 IN(201,202,21,22) OR DIAG3_04 IN(201,202,21,22))
-- MAGIC ORDER BY ARRIVALDATE DESC
-- MAGIC 
-- MAGIC ;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC 
-- MAGIC CREATE TABLE dars_nic_391419_j3w9t_collab.CCU003_KMC_AEactivity_all AS
-- MAGIC 
-- MAGIC SELECT PERSON_ID_DEID, AEKEY, ARRIVALAGE, SEX,ETHNOS,ARRIVALDATE, ARRIVALTIME, AEARRIVALMODE, AEATTENDCAT, PROCODET, SITETRET,AEDEPTTYPE,LSOA11, RESGOR_ONS, DIAG3_01,DIAG3_02, DIAG3_03, DIAG3_04, DIAG3_05, DIAG3_06, DIAG3_07, DIAG3_08, DIAG3_09, DIAG3_10, DIAG3_11, DIAG3_12, TREAT3_01, TREAT3_02, TREAT3_03, TREAT3_04, TREAT3_05, TREAT3_06, TREAT3_07, TREAT3_08, TREAT3_09, TREAT3_10, TREAT3_11, TREAT3_12, DEPDUR, DEPTIME, AEATTENDDISP FROM dars_nic_391419_j3w9t_collab.hes_ae_all_years
-- MAGIC WHERE ARRIVALDATE > '2014-12-31' AND AEATTENDCAT <> 4
-- MAGIC ORDER BY ARRIVALDATE DESC
-- MAGIC ;
